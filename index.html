<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Launch School time estimate</title>
</head>
<body id="body">
  <h1>Check how long it will take you to finish core based on the average figures from the forum</h1>
  
  <div id="mainbody">
    <div>
      <label for="hoursperweek">How many hours do you study per week?:</label>
      <input type="hoursperweek" id="hoursperweek" name="hoursperweek" required
         minlength="1" size="10">
    </div>
    <div>
      <label for="hoursdone">How many hours have you done already?:</label>
      <input type="hoursdone" id="hoursdone" name="hoursdone">
      <button onclick="getHoursPerWeek()">Submit</button>
    </div>
    <div>
      <ul id="list">
      </ul>
    </div>
  </div>

  <div id="insertText">

  </div>
</body>

<style>
  html {
    display: grid;
    grid-template-columns: 1fr min(80ch, 100%) 1fr;
    font-size: 20px;

  }

  body {
  display: grid;
  grid-column: 2;
  place-items: center;
  } 

  h1 {
    font-size: 30px;
  }

  #mainbody {
    display: grid;
    margin: auto;
  }
</style>

<script>
  let launchSchoolHours = {
  JS101: { hours: [190,	149,	307,	113,	102,	165,	78]},
  JS120: { hours: [115, 175,	85,	131,	63,	87,	95,	90]},
  JS130: { hours: [55, 80,	155,	69,	60,	36,	50,	58]},
  JS170: { hours: [30,	26,	30,	38,	17,	35,	37,	9]},
  JS175: { hours: [30,	73,	90,	58,	24,	76,	35,	52]},
  JS180: { hours: [83,	49,	48,	58,	25,	27,	51,	51]},
  JS185: { hours: [8,	10,	15,	15,	7,	12,	10,	16]},
};

function getMaxOfCourse() {
  for (let prop in launchSchoolHours) {
    launchSchoolHours[prop].max = Math.max(...launchSchoolHours[prop].hours);
  }
}

function getMaxTotal() {
  let max = 0;
  for (let prop in launchSchoolHours) {
    if (launchSchoolHours[prop].max)
    max += launchSchoolHours[prop].max;
  }
  
  launchSchoolHours.BackendMax = max;
}

function getBackendAvg() {
  let courseAvg = 0;
  for (let prop in launchSchoolHours) {
    console.log(launchSchoolHours[prop].hours, launchSchoolHours[prop].hours.length);
    launchSchoolHours[prop].average = Math.round(launchSchoolHours[prop].hours.reduce((acc, num) => acc + num) / launchSchoolHours[prop].hours.length)
    courseAvg += launchSchoolHours[prop].average;
  }

  launchSchoolHours.BackendAverage = courseAvg;
  console.log(launchSchoolHours);
}

getMaxOfCourse();
getBackendAvg()
getMaxTotal();
let done = 0;

function displayAverage() {
  let list = document.getElementById("list");
  for (prop in launchSchoolHours) {
    if (launchSchoolHours[prop].average) {
      let li = document.createElement('li');
      let course = document.createTextNode(`${prop} takes on average ${launchSchoolHours[prop].average} hours to complete and the max on record is ${launchSchoolHours[prop].max}.`);
      li.appendChild(course);
      document.getElementById('list').appendChild(li);
    }
  }

  let li = document.createElement('li');
  let courseAvg = launchSchoolHours.BackendAverage;
  let courseAvgNode = document.createTextNode(`The average time to finish the backend course is: ${courseAvg}.`)
  li.appendChild(courseAvgNode);
  document.getElementById('list').appendChild(li);

  let li2 = document.createElement('li');
  let courseMax = launchSchoolHours.BackendMax;
  let courseMaxNode = document.createTextNode(`The Max time on record to finish the backend course is: ${courseMax}.`);
  li2.appendChild(courseMaxNode);
  document.getElementById('list').appendChild(li2);
}


function getHoursPerWeek() {
  let hours = Number(document.getElementById("hoursperweek").value);
  getTotalHoursDone();
  let total = launchSchoolHours.BackendAverage - done;
  let maxTotal = launchSchoolHours.BackendMax - done;
  let now = new Date();
  now.setDate(now.getDate() + ((maxTotal / hours) * 7));
  let then = new Date();
  console.log(((maxTotal / hours) * 7));
  then.setDate(then.getDate() + ((total / hours) * 7));
  console.log(((total / hours) * 7));

  let div2 = document.createElement('div');
  document.getElementById('insertText').appendChild(div2);
  let left = document.createTextNode(`Based on the average it will probably take you another ${total} hours or ${
    Math.round(total / hours)
      } weeks. This means that you would finish on ${then.toDateString()}`);
  div2.appendChild(left);

  let maxDiv = document.createElement('div');
  document.getElementById('insertText').appendChild(maxDiv);
  let maxLeft = document.createTextNode(`Based on the max on record it could take you another ${maxTotal} hours or ${
    Math.round(maxTotal / hours)
      } weeks. This means you would finish on ${now.toDateString()}`);
  maxDiv.appendChild(maxLeft);
}


function getTotalHoursDone() {
  done = Number(document.getElementById("hoursdone").value);
}

displayAverage();


</script>
</html>